webpackJsonp([250],{1877:function(e,t,a){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=a(0),o=a.n(i),l=a(24),c=a.n(l),u=a(2164),d=a(2),m=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),h=function(e){function t(){return n(this,t),s(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return r(t,e),m(t,[{key:"componentDidMount",value:function(){Object(u.a)(this.refs.container,this.props.component)}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement(c.a,{title:Object(d.translate)("custom_measures.page")}),o.a.createElement("div",{ref:"container"}))}}]),t}(o.a.PureComponent);t.default=h},1960:function(e,t,a){"use strict";var n=a(5),s=(a.n(n),a(17)),r=a.n(s);t.a=r.a.Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/metrics"},sync:function(e,t,a){var s=a||{};return"create"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/create",type:"POST",data:Object(n.pick)(t.toJSON(),"key","name","description","domain","type")}),"update"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/update",type:"POST",data:Object(n.pick)(t.toJSON(),"id","key","name","description","domain","type")}),"delete"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/delete",type:"POST",data:{ids:this.id}}),r.a.ajax(s)}})},1981:function(e,t,a){"use strict";var n=a(17),s=a.n(n),r=a(1960);t.a=s.a.Collection.extend({model:r.a,url:function(){return window.baseUrl+"/api/metrics/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.metrics},fetch:function(e){var t=Object.assign({data:{}},e);return this.q=t.data.q,t.data.isCustom=!0,s.a.Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps}})},2019:function(e,t,a){"use strict";var n=a(5),s=(a.n(n),a(17)),r=a.n(s);t.a=r.a.Model.extend({idAttribute:"id",urlRoot:function(){return window.baseUrl+"/api/custom_measures"},sync:function(e,t,a){var s=a||{};return"create"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/create",type:"POST",data:Object(n.pick)(t.toJSON(),"metricId","value","description","projectId")}),"update"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/update",type:"POST",data:Object(n.pick)(t.toJSON(),"id","value","description")}),"delete"===e&&Object(n.defaults)(s,{url:this.urlRoot()+"/delete",type:"POST",data:{id:this.id}}),r.a.ajax(s)}})},2020:function(e,t,a){"use strict";var n=a(36),s=a(1981),r=a(2170),i=a.n(r);t.a=n.a.extend({template:i.a,initialize:function(){this.metrics=new s.a,this.listenTo(this.metrics,"reset",this.render),this.metrics.fetch({reset:!0})},onRender:function(){n.a.prototype.onRender.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"}),this.$("#create-custom-measure-metric").select2({width:"250px",minimumResultsForSearch:20})},onDestroy:function(){n.a.prototype.onDestroy.apply(this,arguments),this.$('[data-toggle="tooltip"]').tooltip("destroy")},onFormSubmit:function(){n.a.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},getAvailableMetrics:function(){var e=this.collection.getTakenMetrics();return this.metrics.toJSON().filter(function(t){return-1===e.indexOf(t.id)})},serializeData:function(){var e=this.getAvailableMetrics(),t=!this.model;return Object.assign({},n.a.prototype.serializeData.apply(this,arguments),{metrics:e,canCreateMetric:!t||e.length>0})}})},2164:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2165),i=a(2167),o=a(2168),l=a(2172),c=a(2179),u=new s.a.Application,d=function(e,t){this.layout=new r.a({el:e}),this.layout.render(),this.customMeasures=new i.a({projectId:t.id}),this.headerView=new o.a({collection:this.customMeasures,projectId:t.id}),this.layout.headerRegion.show(this.headerView),this.listView=new l.a({collection:this.customMeasures}),this.layout.listRegion.show(this.listView),this.listFooterView=new c.a({collection:this.customMeasures}),this.layout.listFooterRegion.show(this.listFooterView),this.customMeasures.fetch()};u.on("start",function(e){d.call(u,e.el,e.component)}),t.a=function(e,t){u.start({el:e,component:t})}},2165:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2166),i=a.n(r);t.a=s.a.LayoutView.extend({template:i.a,regions:{headerRegion:"#custom-measures-header",listRegion:"#custom-measures-list",listFooterRegion:"#custom-measures-list-footer"}})},2166:function(e,t,a){var n=a(4);e.exports=(n.default||n).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,a,n){return'<div class="page page-limited">\n  <div id="custom-measures-header"></div>\n  <div id="custom-measures-list"></div>\n  <div id="custom-measures-list-footer"></div>\n</div>\n'},useData:!0})},2167:function(e,t,a){"use strict";var n=a(5),s=(a.n(n),a(17)),r=a.n(s),i=a(2019);t.a=r.a.Collection.extend({model:i.a,initialize:function(e){this.projectId=e.projectId},url:function(){return window.baseUrl+"/api/custom_measures/search"},parse:function(e){return this.total=e.total,this.p=e.p,this.ps=e.ps,e.customMeasures},fetch:function(e){var t=Object.assign({data:{}},e);return this.q=t.data.q,t.data.projectId=this.projectId,r.a.Collection.prototype.fetch.call(this,t)},fetchMore:function(){var e=this.p+1;return this.fetch({add:!0,remove:!1,data:{p:e,ps:this.ps,q:this.q}})},refresh:function(){return this.fetch({reset:!0,data:{q:this.q}})},hasMore:function(){return this.total>this.p*this.ps},getTakenMetrics:function(){var e=this.map(function(e){return e.get("metric").id});return Object(n.uniq)(e)}})},2168:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2169),i=a(2171),o=a.n(i);t.a=s.a.ItemView.extend({template:o.a,events:{"click #custom-measures-create":"onCreateClick"},onCreateClick:function(e){e.preventDefault(),this.createCustomMeasure()},createCustomMeasure:function(){new r.a({collection:this.collection,projectId:this.options.projectId}).render()}})},2169:function(e,t,a){"use strict";var n=a(2019),s=a(2020);t.a=s.a.extend({sendRequest:function(){var e=this,t=new n.a({metricId:this.$("#create-custom-measure-metric").val(),value:this.$("#create-custom-measure-value").val(),description:this.$("#create-custom-measure-description").val(),projectId:this.options.projectId});return this.disableForm(),t.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},2170:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({1:function(e,t,s,r){return(0,this.escapeExpression)(n(a(1)).call(e,"custom_measures.update_custom_measure",{name:"t",hash:{},data:r}))},3:function(e,t,s,r){return(0,this.escapeExpression)(n(a(1)).call(e,"custom_measures.create_custom_measure",{name:"t",hash:{},data:r}))},5:function(e,t,a,n,s){var r,i="";return r=t.if.call(e,null!=e?e.canCreateMetric:e,{name:"if",hash:{},fn:this.program(6,n,s),inverse:this.program(10,n,s),data:n}),null!=r&&(i+=r),i},6:function(e,t,s,r,i){var o,l=this.escapeExpression,c='        <div class="modal-field">\n          <label for="create-custom-measure-metric">'+l(n(a(1)).call(e,"custom_measures.metric",{name:"t",hash:{},data:r}))+'<em class="mandatory">*</em></label>\n          <select id="create-custom-measure-metric" name="metric" required>\n';return o=t.each.call(e,null!=e?e.metrics:e,{name:"each",hash:{},fn:this.program(7,r,i),inverse:this.noop,data:r}),null!=o&&(c+=o),c+"          </select>\n        </div>\n"},7:function(e,t,s,r,i){var o,l=this.lambda,c=this.escapeExpression,u='              <option value="'+c(l(null!=e?e.id:e,e))+'" ';return o=n(a(11)).call(e,null!=e?e.id:e,null!=(o=null!=i[1]?i[1].metric:i[1])?o.id:o,{name:"eq",hash:{},fn:this.program(8,r,i),inverse:this.noop,data:r}),null!=o&&(u+=o),u+">"+c(l(null!=e?e.name:e,e))+"</option>\n"},8:function(e,t,a,n){return"selected"},10:function(e,t,s,r){return'        <div class="alert alert-warning">'+(0,this.escapeExpression)(n(a(1)).call(e,"custom_measures.all_metrics_taken",{name:"t",hash:{},data:r}))+"</div>\n"},12:function(e,t,a,n){return"disabled"},14:function(e,t,s,r){return(0,this.escapeExpression)(n(a(1)).call(e,"update_verb",{name:"t",hash:{},data:r}))},16:function(e,t,s,r){return(0,this.escapeExpression)(n(a(1)).call(e,"create",{name:"t",hash:{},data:r}))},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r,i){var o,l=this.escapeExpression,c=this.lambda,u='<form id="create-custom-measure-form" autocomplete="off">\n  <div class="modal-head">\n    <h2>';return o=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(1,r,i),inverse:this.program(3,r,i),data:r}),null!=o&&(u+=o),u+='</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n\n',o=t.unless.call(e,null!=e?e.id:e,{name:"unless",hash:{},fn:this.program(5,r,i),inverse:this.noop,data:r}),null!=o&&(u+=o),u+='\n    <div class="modal-field">\n      <label for="create-custom-measure-value">'+l(n(a(1)).call(e,"value",{name:"t",hash:{},data:r}))+'<em class="mandatory">*</em></label>\n      <input id="create-custom-measure-value" name="value" type="text" maxlength="200" required value="'+l(c(null!=e?e.value:e,e))+'">\n    </div>\n\n    <div class="modal-field">\n      <label for="create-custom-measure-description">'+l(n(a(1)).call(e,"description",{name:"t",hash:{},data:r}))+'</label>\n      <textarea id="create-custom-measure-description" name="description">'+l(c(null!=e?e.description:e,e))+'</textarea>\n    </div>\n  </div>\n  <div class="modal-foot">\n    <button id="create-custom-measure-submit" ',o=t.unless.call(e,null!=e?e.canCreateMetric:e,{name:"unless",hash:{},fn:this.program(12,r,i),inverse:this.noop,data:r}),null!=o&&(u+=o),u+=">\n      ",o=t.if.call(e,null!=e?e.id:e,{name:"if",hash:{},fn:this.program(14,r,i),inverse:this.program(16,r,i),data:r}),null!=o&&(u+=o),u+'\n    </button>\n    <a href="#" class="js-modal-close" id="create-custom-measure-cancel">'+l(n(a(1)).call(e,"cancel",{name:"t",hash:{},data:r}))+"</a>\n  </div>\n</form>\n"},useData:!0,useDepths:!0})},2171:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r){var i=this.escapeExpression;return'<header class="page-header">\n  <h1 class="page-title">'+i(n(a(1)).call(e,"custom_measures.page",{name:"t",hash:{},data:r}))+'</h1>\n  <div class="page-actions">\n    <button id="custom-measures-create">'+i(n(a(1)).call(e,"create",{name:"t",hash:{},data:r}))+'</button>\n  </div>\n  <p class="page-description">'+i(n(a(1)).call(e,"custom_measures.page.description",{name:"t",hash:{},data:r}))+"</p>\n</header>\n"},useData:!0})},2172:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2173),i=a(2178),o=a.n(i);t.a=s.a.CompositeView.extend({template:o.a,childView:r.a,childViewContainer:"tbody"})},2173:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2174),i=a(2175),o=a(2177),l=a.n(o);t.a=s.a.ItemView.extend({tagName:"tr",template:l.a,events:{"click .js-custom-measure-update":"onUpdateClick","click .js-custom-measure-delete":"onDeleteClick"},onRender:function(){this.$el.attr("data-id",this.model.id),this.$('[data-toggle="tooltip"]').tooltip({container:"body",placement:"bottom"})},onDestroy:function(){this.$('[data-toggle="tooltip"]').tooltip("destroy")},onUpdateClick:function(e){e.preventDefault(),this.updateCustomMeasure()},onDeleteClick:function(e){e.preventDefault(),this.deleteCustomMeasure()},updateCustomMeasure:function(){new r.a({model:this.model,collection:this.model.collection}).render()},deleteCustomMeasure:function(){new i.a({model:this.model}).render()}})},2174:function(e,t,a){"use strict";var n=a(2020);t.a=n.a.extend({sendRequest:function(){var e=this;return this.model.set({value:this.$("#create-custom-measure-value").val(),description:this.$("#create-custom-measure-description").val()}),this.disableForm(),this.model.save(null,{statusCode:{400:null}}).done(function(){e.collection.refresh(),e.destroy()}).fail(function(t){e.enableForm(),e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},2175:function(e,t,a){"use strict";var n=a(36),s=a(2176),r=a.n(s);t.a=n.a.extend({template:r.a,onFormSubmit:function(){n.a.prototype.onFormSubmit.apply(this,arguments),this.sendRequest()},sendRequest:function(){var e=this,t=this.model.collection;return this.model.destroy({wait:!0,statusCode:{400:null}}).done(function(){t.refresh(),e.destroy()}).fail(function(t){e.showErrors(t.responseJSON.errors,t.responseJSON.warnings)})}})},2176:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r){var i,o=this.escapeExpression;return'<form id="delete-custom-measure-form">\n  <div class="modal-head">\n    <h2>'+o(n(a(1)).call(e,"custom_measures.delete_custom_measure",{name:"t",hash:{},data:r}))+'</h2>\n  </div>\n  <div class="modal-body">\n    <div class="js-modal-messages"></div>\n    '+o(n(a(28)).call(e,"custom_measures.delete_custom_measure.confirmation",null!=(i=null!=e?e.metric:e)?i.name:i,{name:"tp",hash:{},data:r}))+'\n  </div>\n  <div class="modal-foot">\n    <button id="delete-custom-measure-submit" class="button-red">'+o(n(a(1)).call(e,"delete",{name:"t",hash:{},data:r}))+'</button>\n    <a href="#" class="js-modal-close" id="delete-custom-measure-cancel">'+o(n(a(1)).call(e,"cancel",{name:"t",hash:{},data:r}))+"</a>\n  </div>\n</form>\n"},useData:!0})},2177:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({1:function(e,t,s,r){var i=this.escapeExpression;return'      <span class="js-custom-measure-pending badge badge-warning spacer-left"\n            title="'+i(n(a(1)).call(e,"custom_measures.pending_tooltip",{name:"t",hash:{},data:r}))+'"\n            data-toggle="tooltip" data-placement="bottom">'+i(n(a(1)).call(e,"custom_measures.pending",{name:"t",hash:{},data:r}))+"</span>\n"},3:function(e,t,s,r){var i=this.escapeExpression;return"    "+i(n(a(1)).call(e,"updated_on",{name:"t",hash:{},data:r}))+' <span class="js-custom-measure-created-at">'+i(n(a(342)).call(e,null!=e?e.updatedAt:e,{name:"d",hash:{},data:r}))+"</span>\n"},5:function(e,t,a,n){var s,r="";return s=t.if.call(e,null!=e?e.createdAt:e,{name:"if",hash:{},fn:this.program(6,n),inverse:this.program(8,n),data:n}),null!=s&&(r+=s),r},6:function(e,t,s,r){var i=this.escapeExpression;return"      "+i(n(a(1)).call(e,"created_on",{name:"t",hash:{},data:r}))+' <span class="js-custom-measure-created-at">'+i(n(a(342)).call(e,null!=e?e.createdAt:e,{name:"d",hash:{},data:r}))+"</span>\n"},8:function(e,t,s,r){return"      "+(0,this.escapeExpression)(n(a(1)).call(e,"created",{name:"t",hash:{},data:r}))+" \n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r){var i,o=this.lambda,l=this.escapeExpression,c='<td class="nowrap">\n  <div>\n    <span class="js-custom-measure-metric-name">'+l(o(null!=(i=null!=e?e.metric:e)?i.name:i,e))+"</span>\n";return i=t.if.call(e,null!=e?e.pending:e,{name:"if",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),null!=i&&(c+=i),c+='  </div>\n  <span class="js-custom-measure-domain note">'+l(o(null!=(i=null!=e?e.metric:e)?i.domain:i,e))+'</span>\n</td>\n\n<td class="nowrap">\n  <strong class="js-custom-measure-value">'+l(n(a(54)).call(e,null!=e?e.value:e,null!=(i=null!=e?e.metric:e)?i.type:i,{name:"formatMeasure",hash:{},data:r}))+'</strong>\n</td>\n\n<td class="">\n  <span class="js-custom-measure-description">'+l(o(null!=e?e.description:e,e))+'</span>\n</td>\n\n<td class="">\n',i=t.if.call(e,null!=e?e.updatedAt:e,{name:"if",hash:{},fn:this.program(3,r),inverse:this.program(5,r),data:r}),null!=i&&(c+=i),c+"  "+l(n(a(1)).call(e,"by_",{name:"t",hash:{},data:r}))+' <span class="js-custom-measure-user">'+l(o(null!=(i=null!=e?e.user:e)?i.name:i,e))+'</span>\n</td>\n\n<td class="thin nowrap">\n  <div class="dropdown">\n    <button class="dropdown-toggle" data-toggle="dropdown">\n      '+l(n(a(612)).call(e,{name:"settingsIcon",hash:{},data:r}))+'<i class="icon-dropdown little-spacer-left" />\n    </button>\n    <ul class="dropdown-menu dropdown-menu-right">\n      <li>\n        <a class="js-custom-measure-update" href="#">'+l(n(a(1)).call(e,"update_verb",{name:"t",hash:{},data:r}))+'</a>\n      </li>\n      <li class="divider" />\n      <li>\n        <a class="js-custom-measure-delete text-danger" href="#">'+l(n(a(1)).call(e,"delete",{name:"t",hash:{},data:r}))+"</a>\n      </li>\n    </ul>\n  </div>\n</td>\n"},useData:!0})},2178:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r){var i=this.escapeExpression;return'<div class="boxed-group boxed-group-inner">\n  <table class="data zebra">\n    <thead>\n    <tr>\n      <th>'+i(n(a(1)).call(e,"custom_measures.metric",{name:"t",hash:{},data:r}))+"</th>\n      <th>"+i(n(a(1)).call(e,"value",{name:"t",hash:{},data:r}))+"</th>\n      <th>"+i(n(a(1)).call(e,"description",{name:"t",hash:{},data:r}))+"</th>\n      <th>"+i(n(a(1)).call(e,"date",{name:"t",hash:{},data:r}))+"</th>\n      <th>&nbsp;</th>\n    </tr>\n    </thead>\n    <tbody></tbody>\n  </table>\n</div>\n"},useData:!0})},2179:function(e,t,a){"use strict";var n=a(12),s=a.n(n),r=a(2180),i=a.n(r);t.a=s.a.ItemView.extend({template:i.a,collectionEvents:{all:"render"},events:{"click #custom-measures-fetch-more":"onMoreClick"},onMoreClick:function(e){e.preventDefault(),this.fetchMore()},fetchMore:function(){this.collection.fetchMore()},serializeData:function(){return Object.assign({},s.a.ItemView.prototype.serializeData.apply(this,arguments),{total:this.collection.total,count:this.collection.length,more:this.collection.hasMore()})}})},2180:function(e,t,a){function n(e){return e&&(e.__esModule?e.default:e)}var s=a(4);e.exports=(s.default||s).template({1:function(e,t,s,r){return'    <a id="custom-measures-fetch-more" class="spacer-left" href="#">'+(0,this.escapeExpression)(n(a(1)).call(e,"show_more",{name:"t",hash:{},data:r}))+"</a>\n"},compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,s,r){var i,o=this.escapeExpression,l='<footer class="spacer-top note text-center">\n  '+o(n(a(28)).call(e,"x_of_y_shown",null!=e?e.count:e,null!=e?e.total:e,{name:"tp",hash:{},data:r}))+"\n";return i=t.if.call(e,null!=e?e.more:e,{name:"if",hash:{},fn:this.program(1,r),inverse:this.noop,data:r}),null!=i&&(l+=i),l+"</footer>\n"},useData:!0})}});
//# sourceMappingURL=250.1338d15f.chunk.js.map