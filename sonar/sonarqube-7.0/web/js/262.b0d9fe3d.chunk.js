webpackJsonp([262],{1871:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"UnconnectedNotifications",function(){return O});var i=n(0),c=n.n(i),l=n(24),u=n.n(l),s=n(9),f=n(2088),p=n(2090),h=n(2),y=n(1977),b=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),m=c.a.createElement(f.a,null),d=c.a.createElement(p.a,null),j=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),b(t,[{key:"componentDidMount",value:function(){this.props.fetchNotifications()}},{key:"render",value:function(){return c.a.createElement("div",{className:"account-body account-container"},c.a.createElement(u.a,{title:Object(h.translate)("my_account.notifications")}),c.a.createElement("p",{className:"alert alert-info"},Object(h.translate)("notification.dispatcher.information")),m,d)}}]),t}(c.a.PureComponent),v={fetchNotifications:y.b};t.default=Object(s.connect)(null,v)(j);var O=j},1928:function(e,t,n){"use strict";function o(e){var t=e.link,n=void 0===t||t,o=e.organization;return e.shouldBeDisplayed&&o?r.createElement("span",null,n?r.createElement(c.a,{className:e.linkClassName,organization:o},o.name):o.name,r.createElement("span",{className:"slash-separator"})):null}var r=n(0),a=(n.n(r),n(9)),i=n(10),c=n(583),l=function(e,t){return{organization:Object(i.getOrganizationByKey)(e,t.organizationKey),shouldBeDisplayed:Object(i.areThereCustomOrganizations)(e)}};t.a=Object(a.connect)(l)(o)},1977:function(e,t,n){"use strict";n.d(t,"b",function(){return i}),n.d(t,"a",function(){return c}),n.d(t,"c",function(){return l});var o=n(2089),r=n(135),a=n(619),i=function(){return function(e){var t=function(t){var n=t.notifications.filter(function(e){return e.organization}).map(function(e){return e.organization});e(Object(r.f)(n)).then(function(){e(Object(a.i)(t.notifications,t.channels,t.globalTypes,t.perProjectTypes))})};return o.b().then(t,Object(r.g)(e))}},c=function(e){return function(t){return o.a(e.channel,e.type,e.project).then(function(){return t(Object(a.a)(e))},Object(r.g)(t))}},l=function(e){return function(t){return o.c(e.channel,e.type,e.project).then(function(){return t(Object(a.j)(e))},Object(r.g)(t))}}},2009:function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=n(0),l=n.n(c),u=n(100),s=n(2),f=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),p=function(e){function t(){return r(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),f(t,[{key:"isEnabled",value:function(e,t){return!!this.props.notifications.find(function(n){return n.type===e&&n.channel===t})}},{key:"handleCheck",value:function(e,t,n){n?this.props.onAdd({type:e,channel:t}):this.props.onRemove({type:e,channel:t})}},{key:"getDispatcherLabel",value:function(e){var t=["notification.dispatcher",e],n=[].concat(t,["project"]);return this.props.project&&s.hasMessage.apply(void 0,o(n))?s.translate.apply(void 0,o(n)):s.translate.apply(void 0,t)}},{key:"render",value:function(){var e=this,t=this.props,n=t.channels,o=t.checkboxId,r=t.types;return l.a.createElement("tbody",null,r.map(function(t){return l.a.createElement("tr",{key:t},l.a.createElement("td",null,e.getDispatcherLabel(t)),n.map(function(n){return l.a.createElement("td",{key:n,className:"text-center"},l.a.createElement(u.a,{checked:e.isEnabled(t,n),id:o(t,n),onCheck:function(o){return e.handleCheck(t,n,o)}}))}))}))}}]),t}(l.a.PureComponent);t.a=p},2088:function(e,t,n){"use strict";function o(e){return a.a.createElement("section",{className:"boxed-group"},a.a.createElement("h2",null,Object(l.translate)("my_profile.overall_notifications.title")),a.a.createElement("div",{className:"boxed-group-inner"},a.a.createElement("table",{className:"form"},a.a.createElement("thead",null,a.a.createElement("tr",null,f,e.channels.map(function(e){return a.a.createElement("th",{key:e,className:"text-center"},a.a.createElement("h4",null,Object(l.translate)("notification.channel",e)))}))),a.a.createElement(c.a,{notifications:e.notifications,channels:e.channels,types:e.types,checkboxId:function(e,t){return"global-notification-"+e+"-"+t},onAdd:e.addNotification,onRemove:e.removeNotification}))))}var r=n(0),a=n.n(r),i=n(9),c=n(2009),l=n(2),u=n(10),s=n(1977),f=a.a.createElement("th",null),p=function(e){return{notifications:Object(u.getGlobalNotifications)(e),channels:Object(u.getNotificationChannels)(e),types:Object(u.getNotificationGlobalTypes)(e)}},h={addNotification:s.a,removeNotification:s.c};t.a=Object(i.connect)(p,h)(o)},2089:function(e,t,n){"use strict";function o(){return Object(i.getJSON)("/api/notifications/list")}function r(e,t,n){var o={channel:e,type:t};return n&&Object.assign(o,{project:n}),Object(i.post)("/api/notifications/add",o)}function a(e,t,n){var o={channel:e,type:t};return n&&Object.assign(o,{project:n}),Object(i.post)("/api/notifications/remove",o)}t.b=o,t.a=r,t.c=a;var i=n(14)},2090:function(e,t,n){"use strict";function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=n(0),l=n.n(c),u=n(9),s=n(5),f=(n.n(s),n(2091)),p=n(175),h=n(1928),y=n(2),b=n(51),m=n(10),d=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),j=function(e){function t(){var e,n,i,c;r(this,t);for(var u=arguments.length,s=Array(u),f=0;f<u;f++)s[f]=arguments[f];return n=i=a(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(s))),i.state={addedProjects:[]},i.loadOptions=function(e,t){if(e.length<2)return void t(null,{options:[]});Object(b.s)(e).then(function(e){var t=e.results.find(function(e){return"TRK"===e.q});return t?t.items:[]}).then(function(e){return e.map(function(e){return{value:e.key,label:e.name,organization:e.organization}})}).then(function(e){t(null,{options:e})})},i.handleAddProject=function(e){var t={key:e.value,name:e.label,organization:e.organization};i.setState({addedProjects:[].concat(o(i.state.addedProjects),[t])})},i.renderOption=function(e){return l.a.createElement("span",null,l.a.createElement(h.a,{organizationKey:e.organization,link:!1}),l.a.createElement("strong",null,e.label))},c=n,a(i,c)}return i(t,e),d(t,[{key:"componentWillReceiveProps",value:function(e){var t=Object(s.differenceBy)(this.state.addedProjects,e.projects,function(e){return e.key});t.length!==this.state.addedProjects&&this.setState({addedProjects:t})}},{key:"render",value:function(){var e=[].concat(o(this.props.projects),o(this.state.addedProjects));return l.a.createElement("section",{className:"boxed-group"},l.a.createElement("h2",null,Object(y.translate)("my_profile.per_project_notifications.title")),l.a.createElement("div",{className:"boxed-group-inner"},0===e.length&&l.a.createElement("div",{className:"note"},Object(y.translate)("my_account.no_project_notifications")),e.map(function(e){return l.a.createElement(f.a,{key:e.key,project:e})}),l.a.createElement("div",{className:"spacer-top panel bg-muted"},l.a.createElement("span",{className:"text-middle spacer-right"},Object(y.translate)("my_account.set_notifications_for"),":"),l.a.createElement(p.a,{autoload:!1,cache:!1,name:"new_project",style:{width:"300px"},loadOptions:this.loadOptions,minimumInput:2,optionRenderer:this.renderOption,onChange:this.handleAddProject,placeholder:Object(y.translate)("my_account.search_project")}))))}}]),t}(l.a.PureComponent),v=function(e){return{projects:Object(m.getProjectsWithNotifications)(e)}};t.a=Object(u.connect)(v)(j)},2091:function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=n(0),c=n.n(i),l=n(9),u=n(13),s=n(2009),f=n(1928),p=n(2),h=n(10),y=n(1977),b=n(26),m=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),d=function(e){function t(){return o(this,t),r(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return a(t,e),m(t,[{key:"handleAddNotification",value:function(e){var t=e.channel,n=e.type;this.props.addNotification({channel:t,type:n,project:this.props.project.key,projectName:this.props.project.name,organization:this.props.project.organization})}},{key:"handleRemoveNotification",value:function(e){var t=e.channel,n=e.type;this.props.removeNotification({channel:t,type:n,project:this.props.project.key})}},{key:"render",value:function(){var e=this,t=this.props,n=t.project,o=t.channels;return c.a.createElement("table",{key:n.key,className:"form big-spacer-bottom"},c.a.createElement("thead",null,c.a.createElement("tr",null,c.a.createElement("th",null,c.a.createElement("span",{className:"text-normal"},c.a.createElement(f.a,{organizationKey:n.organization})),c.a.createElement("h4",{className:"display-inline-block"},c.a.createElement(u.Link,{to:Object(b.o)(n.key)},n.name))),o.map(function(e){return c.a.createElement("th",{key:e,className:"text-center"},c.a.createElement("h4",null,Object(p.translate)("notification.channel",e)))}))),c.a.createElement(s.a,{notifications:this.props.notifications,channels:this.props.channels,types:this.props.types,checkboxId:function(e,t){return"project-notification-"+n.key+"-"+e+"-"+t},onAdd:function(t){return e.handleAddNotification(t)},onRemove:function(t){return e.handleRemoveNotification(t)},project:!0}))}}]),t}(c.a.PureComponent),j=function(e,t){return{notifications:Object(h.getProjectNotifications)(e,t.project.key),channels:Object(h.getNotificationChannels)(e),types:Object(h.getNotificationPerProjectTypes)(e)}},v={addNotification:y.a,removeNotification:y.c};t.a=Object(l.connect)(j,v)(d)}});
//# sourceMappingURL=262.b0d9fe3d.chunk.js.map